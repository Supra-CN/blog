title: git share
speaker: 王佳
transition: slide3
theme: moon
usemathjax: yes

[slide]
# git share 
## 版本控制（Version control system）背景知识
 * **作用** - 用于维护项目的变化，以便实现版本溯源，多版本发布，多人协同维护等目的。 {:&.rollIn}
 * **类型** - 主要分为中央式系统（Centralized Version Control System）与分布式系统（Distributed Version Control System）
    - **史前** - diff patch tar 或者 [毕业论文最新版.doc、毕业论文最终版.doc、我和老师.avi (n)](https://s-media-cache-ak0.pinimg.com/564x/7e/de/83/7ede832f6c1680093110b6fe782af4e6.jpg) {:&.rollIn}
    - **中央式系统（CVCS）** - 由中央权威管理访问权限，不同协作者的不同版本需要通过中央节点进行沟通交流，如： CVS、Subversion 以及 Perforce 等
    - **分布式系统（DVCS）** - 协作者的各个节点相互平等，每个节点都包含完整的项目信息，便于节点和版本之间的沟通交流，如Git、BitKeeper、Mercurial、Bazaar 以及 Darcs 等：
[note]
![我和老师](https://s-media-cache-ak0.pinimg.com/564x/7e/de/83/7ede832f6c1680093110b6fe782af4e6.jpg "我和老师")
[/note]

[slide]
## Git简介
 * git是用于Linux内核开发的版本控制工具。与CVS、Subversion一类的集中式版本控制工具不同，它采用了分布式版本库的作法，不需要服务器端软件，就可以运作版本控制，使得源代码的发布和交流极其方便。git的速度很快，这对于诸如Linux内核这样的大项目来说自然很重要。git最为出色的是它的合并追踪（merge tracing）能力。 {:&.rollIn}
 * 设计目标：高度易用、速度、简单的设计、非线性开发模式、完全分布式、有能力高效管理类似 Linux 内核一样的超大规模项目（速度和数据量）。
 * 作为开源自由原教旨主义项目，git没有对版本库的浏览和修改做任何的权限限制，通过其他工具也可以达到有限的权限控制

[slide]
## Git简史
 * **1991－2002年间**,由于Linus不愿接受集中式VCS的缘故，Linux项目的众多开发者被提交补丁和保存归档的繁琐事务所困扰； {:&.rollIn}
 * **2002年**，Linux项目开始启用专有分布式VCS工具BitKeeper。
 * **2005年4月**，Samba的作者Andrew Tridgell逆向了BitKeeper，打算山寨一个BitKeeper，激怒了BitKeeper公司，一言不合收回了Linux社区的BitKeeper免费使用权；Linux Torvalds一怒之下以十天的时间，编写出自己的版本系统Git的第一个版本，
    - **4月3日**开始开发Git， {:&.rollIn}
    - **4月6日**Git项目发布，
    - **4月7日**Git实现对项目自身代码的版本管理，
    - **4月18日**发生第一次多分支合并。
    - **4月29日**基础功能性能完备，6月16日Linux项目迁移到Git。
    - **7月26日**Linus将Git交于滨野纯(Junio C Hamano)维护至今。

[slide]
## Git和SVN的基本区别
 * GIT是分布式的，SVN不是：
 * GIT把内容按元数据方式存储，而SVN是按文件：
 * GIT分支和SVN的分支不同：
 * GIT没有一个全局的版本号，而SVN有：
 * GIT的内容完整性要优于SVN：
 
[slide]
## Git和SVN的基本区别
### GIT是分布式的，SVN不是：
 * 这是GIT和SVN最核心的区别。如果你能理解这个概念，那么你就已经上手一半了。GIT很多多强大的功能特征都得益于此。 {:&.rollIn}
 * GIT可以拥有跟SVN类似的集中式版本库或服务器。但，GIT更倾向于被使用于分布式模式，也就是每个开发人员都可以从中心版本库上克隆一个自己的完整版本库。网络的要求大大降低了。对版本库操作的便利性和完整性却大大提高了，
 * 同样，这种分布式的操作模式对于开发协作者来说也是个巨大的恩赐，你不必再像以前那样做出补丁包，通过email方式发送出去，你只需要创建一个分支，向项目团队成员发送一个推请求。这能让你的代码保持最新，而且不会在传输过程中丢失。GitHub.com就是一个这样的优秀案例。
 
[slide]
## Git和SVN的基本区别
### GIT把内容按元数据方式存储，而SVN是按文件：
 * 所有的资源控制系统都是把文件的元信息隐藏在一个类似.svn,.cvs等的文件夹里。如果你把.git目录的体积大小跟.svn比较，你会发现它们差距很大。因为,.git目录是处于你的机器上的一个克隆版的版本库，它拥有中心版本库上所有的东西，例如标签，分支，版本记录等。
 
[slide]
## Git和SVN的基本区别
### GIT分支和SVN的分支不同：
 * 分支在SVN中一点不特别，就是版本库中的另外的一个目录。如果你想知道是否合并了一个分支，你需要手工运行像这样的命令svn propget svn:mergeinfo，来确认代码是否被合并。感谢Ben同学指出这个特征。所以，经常会发生有些分支被遗漏的情况。
然而，处理GIT的分支却是相当的简单和有趣。你可以从同一个工作目录下快速的在几个分支间切换。你很容易发现未被合并的分支，你能简单而快捷的合并这些文件。
 
[slide]
## Git和SVN的基本区别
### GIT没有明确序列化的版本号，而SVN有递增的数字版本号：
 * 目前为止这是跟SVN相比GIT缺少的最大的一个特征。你也知道，SVN的版本号实际是任何一个相应时间的源代码快照。它是从CVS进化到SVN的最大的一个突破。因为GIT和SVN从概念上就不同。GIT的SHA-1来唯一的标识一个提交代码快照

[slide]
## Git和SVN的基本区别
### GIT的内容完整性要优于SVN：
 * GIT的内容存储使用的是SHA-1哈希算法。这能确保代码内容的完整性，确保在遇到磁盘故障和网络问题时降低对版本库的破坏。这里有一个很好的关于GIT内容完整性的讨论 – http://stackoverflow.com/questions/964331/git-file-integrity

[slide]
## Git相对SVN的优势
 * 使用Git，团队规模不受版本库工具自身的限制 
 * Git分支功能最为强大，分支管理能力让SVN望尘莫及
 * Git可以实现更好的发布控制
 * 隔离开发，提交审核
 * 对合并更好的支持，更少的冲突，更好的冲突解决
 * 保证已修复Bug不再重现
 * 版本库的安全性
 * 更多理由

[slide]
## Git相对SVN的优势
### 使用Git，团队规模不受版本库工具自身的限制
 * 最坏的情况下（每次提交都要会修改同一文件，例如版本库中仅包含一个文件），一个SVN版本库的每小时提交次数存在上限。如果无冲突合并再提交需用时30秒、冲突解决再提交用时300秒，这个上限可能是每小时40个提交。据此一个相对密集开发的版本库拥有四五十个提交账号可能就是极限。
 * Git的提交是在本地完成的，加之可以采用版本库分级控制的分布式开发模型，因此只有天空才是极限。

[slide]
## Git相对SVN的优势
### Git可以很容易地对比两个分支，知道一个分支中哪些提交尚未合并到另一分支，反之亦然。

 * 查看当前分支比other分支多了哪些提交：
```
  $ git log other..
```
 * 查看other分支比当前分支多了哪些提交：
```
  $ git log ..other
```
 * 我不认为SVN的分支是真正的分支，因为分支最基本的提交隔离SVN就没能实现。 在SVN中一次提交可以同时更改主线（/trunk）和分支中的内容， 所以判断一个分支中哪些提交未合并到另外的分支，完全不能对SVN抱有希望。

[slide]
## Git相对SVN的优势
### Git可以实现更好的发布控制
针对同一个项目，Git可以设置不同层级的版本库（多版本库）， 或者通过不同的分支（多分支）实现对发布的控制。

 * 设置只有发布管理员才有权限推送的版本库或者分支，用于稳定发布版本的维护。  {:&.rollIn}
 * 设置只有项目经理、模块管理员才有权推送的版本库或者分支，用用于整合测试。

[slide]
## Git相对SVN的优势
### 隔离开发，提交审核
 * 如何对团队中的新成员的开发进行审核呢？在Git服务器上可以实现用户自建分支和自建版本库的功能， 这样团队中的新成员既能将本地提交推送到服务器以对工作进行备份， 又能够方便团队中的其他成员对自己的提交进行审核。
 * 审核新成员提交时，从其个人版本库或个人分支获取（fetch）提交，从提交说明、代码规范、编译测试 等多方面对提交逐一审核。审核通过执行 git merge 命令合并到开发主线中。

[slide]
## Git相对SVN的优势
### 对合并更好的支持，更少的冲突，更好的冲突解决
 * 因为Git基于对内容的追踪而非对文件名追踪，所以遇到一方或双方对文件名更改时， Git能够很好进行自动合并或提供工具辅助合并。而SVN遇到同样问题时会产生树冲突， 解决起来很麻烦。
 * Git的基于DAG（有向非环图）的设计比SVN的线性提交提供更好的合并追踪， 避免不必要的冲突，提高工作效率。这是开发者选择Git、抛弃SVN的重要理由。

[slide]
## Git相对SVN的优势
### 保证已修复Bug不再重现
 * 以为创建完毕里程碑标签（tag）便完成软件版本的发布是有风险的， 往往会由于之前的版本（维护版本）中的一些 Hotfix 提交没有合并到最新版本而造成已修复问题在新版本中重现。
 * Git分支和合并追踪可以解决这个问题。例如用 maint 分支跟踪最新的发行版， 当确定里程碑tag v1.6.4 为最新发行版时，在 maint 分支执行如下命令以切换到最新发行版：
```
$ git checkout maint
$ git merge --ff-only v1.6.4
```
 * 如果合并成功，代表发行版 v1.6.4 包含了所有前一个发行版的提交。 反之说明前一个发行版某个或某些Hotfix提交尚未合并到最新发行版中。

[slide]
## Git相对SVN的优势
### 版本库的安全性
SVN版本库安全性很差，是管理员头痛的问题。

 * SVN版本库服务器端历史数据被篡改，或者硬盘故障导致历史数据被篡改时， 客户端很难发现。管理员的备份也会被污染。  {:&.rollIn}
 * SVN作为集中式版本控制系统，存在单点故障的风险。备份版本库的任务非常繁重。
 * Git在这方面完胜SVN。首先Git是分布式版本控制系统，每个用户都相当于一份备份， 管理员无需为数据备份而担心。再有Git中包括提交、文件内容等都通过SHA1哈希保证数据的完整性， 任何恶意篡改历史数据都会被及时发现从而被挫败。



[slide]
## Git相对SVN的优势
### 更多的十条喜欢Git的理由，参见《Git权威指南》第11-21页。
    
 * 异地协同工作。  {:&.rollIn}
 * 现场版本控制。
 * 重写提交说明。
 * 无尽的后悔药。
 * 更好用的提交列表。
 * 更好的差异比较。
 * 工作进度保存。
 * 作为SVN前端实现移动办公。
 * 无处不在的分页器。
 * 快。


[slide]
## Git在百度应用的主要功能及相对于SVN工具优势：
 * Git代码托管(代码库创建、权限管理、代码评审、代码库同步、在线浏览、代码提交)： 一个系统搞定，再也不用跑多个系统去申请模块、申请产品线、申请权限，添加删除各种代码钩子啦！ {:&.rollIn}
 * 可以本地实现完整代码库操作，秒开分支，本地多分支多story并行开发，无障碍本地提交小功能，发起story合并请求无须无需等待审核，开个新分支接着干新活，妥妥的提升团队效率！分分钟甩SVN两条街.   
 * 代码评审及代码入库检查(可选的人工评审环节，入库编码规范检查、第三方法务等百度代码准入检查，评审通过后一键提交)：提交代码再也不用写ISSUEID啦;评审别人代码，一条命令直接把待评审的代码拉到本地工程，再也不用在浏览器里看代码了，并且完全杜绝了评审通过之后偷偷提交黑户代码的问题，RD只需不停“写码-commit-push”即可，icode自动识别是否发起新评审还是添加patchset
 
 
[slide]
## Git在百度应用的主要功能及相对于SVN工具优势：
 * 贯通研发流水线（对接需求/Bug管理平台iCafe：可基于一张卡片创建一条分支，也可在提交的comments中插入卡片信息关联需求；对接持续交付平台Agile：评审阶段的入库前预测试流水线、提交后触发自动构建、测试流水线）：预测试流水线将质量反馈前置，大大减少入库代码问题！  {:&.rollIn}
 * 分支及版本管理：团队协同开发，如何不丢代码？ iCode帮你妥妥搞定，多种合并模式，代码合并提醒，代码对比展示和一键合并，妈妈再也不用担心我冲掉线上代码啦！
[slide]
### 总而言之
Git的优势就是：
 * **科学** - 以更科学的方式协调维护版本信息，一旦理解之后，一切都变的很自然；
 * **灵活** - 以上帝视角维护项目，版本控制理应如此；
 * **安全** - 重要的东西，存三遍；
 * **快** - 切一个说开就开的分支，写一段说改就改的需求；
[slide]
# 谢谢